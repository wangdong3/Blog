## 数据库设计 

- 分库原则、分表原则（垂直、水平）

- 表设计、冗余设计、字段设计、增量设计、主键生成规则、外键设计、索引设计

1.使用smd工具进行表设计
2.使用utf-8字符集编码
3.表设计列不超过80列
4.使用有序UUID作为主键：索引在磁盘上存储的形式，常用的b-tree 索引，如果id是连续的，那么数据存储在相邻的磁盘上，查询和写入的id连续，会减少磁盘随机读的几率，提升读写效率
5.禁止使用外键，禁止使用触发器
6.长度小于10的用Integer类型，大于10的使用number或numberic,金额单位用元，使用number(20,4)存储
7.blob这样的结构化数据，必须与业务数据分开，设计单表存储，不建议在数据库中存储非结构化信息
8.无论是开发环境或是生产环境，必须配数据库连接池，严格禁止使用数据库管理员用户，作为数据库连接池用户；数据库连接池统一使用Druid

- 触发器使用原则、存储过程使用原则  

### 分库分表  

- 垂直切分：库按业务分类独立划分；大表拆小表；  

```
垂直切分优点：
	- 业务解耦，清晰
	- 微服务治理
	- 高并发场景，提升IO
垂直切分缺点：
	- 部分表无法join，提升开发难度
	- 分布式事务处理复杂
	- 依然存在单表数据量过大的问题  
```

- 水平切分：将同一个表按不同的条件分散到多个数据库或多个表中，每个表只包含部分数据（根据数值范围，根据数值取模）    

```
水平切分优点：
	- 提升负载能力，解决高并发性能瓶颈
	- 不需要拆分业务模块
水平切分缺点：
	- 跨分片事务一致性难以保证
	- 跨库的join关联查询性能较差
	- 数据多次扩展难度和维护量大
```

### 外键约束：  

	1. CASCADE：级联；
	2. NO ACTION(非活动，默认)、RESTRICT：约束/限制；
	3. SET NULL

### 索引设计：  

	1. 必须要有主键，选择唯一性，主键索引和唯一键索引，在查询中使用是效率最高的。
	2. 为经常需要排序分组和联合操作的字段建立索引
	3. 为经常作为where查询条件的字段建立索引
	4. 尽量使用前缀来索引
	5. 限制索引的数目
	6. 删除不再使用或很少使用的索引
	7. 大表加索引要在业务不繁忙期间操作


### 存储过程使用原则：	

	1. 一个业务对多表进行处理的时候采用存储过程比较合适
	2. 复杂的数据处理用存储过程合适，例如报表
	3. 多条件多表联合查询，并做分页处理，存储过程合适
	4. 需求变动，不易维护，不应大规模使用
	5. 适当的使用存储过程，能提高SQL查询性能  
	
### 触发器  

触发器是一种对表进行插入、删除、更改的时候自动运行的特殊的存储过程。它一般用在比核查约束更为复杂的约束中。但能用约束实现的功能，一般不用触发器。